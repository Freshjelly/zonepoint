# YouTube分析ツール - 日本FX特化統合版 テスト手順・受け入れ基準

## 📋 概要
本ドキュメントは、日本FX特化YouTube分析ツールの包括的なテスト手順と受け入れ基準を定義します。
全17項目のテストケースにより、システムの完全性を保証します。

## 🧪 事前準備

### テスト環境の確認
- [ ] Google Apps Script エディタにアクセス可能
- [ ] YouTube Data API v3 が有効化済み
- [ ] Advanced Google Services で YouTube Data API v3 が追加済み
- [ ] APIキーが取得済み（テスト用の制限なしキーを推奨）
- [ ] （オプション）Anthropic または OpenAI の APIキーが取得済み

### テスト実行の注意事項
- APIクォータ制限（1日10,000リクエスト）に注意
- 各テストケース間には十分な間隔を空ける
- エラー発生時は「ログ」シートで詳細を確認
- 大量データ処理時は処理時間を考慮（5-30分程度）

## 🚀 テストケース一覧

### Phase 1: 基本セットアップテスト（必須）
1. [初期セットアップテスト](#test-01)
2. [メニュー表示テスト](#test-02) 
3. [APIキー設定テスト](#test-03)
4. [シート構成テスト](#test-04)

### Phase 2: チャンネル発見機能テスト（コア機能）
5. [日本FX特化チャンネル発見テスト](#test-05)
6. [フィルタリング精度テスト](#test-06)
7. [チャンネルURL生成テスト](#test-07)

### Phase 3: 分析機能テスト（統合版継承）
8. [チャンネル分析テスト](#test-08)
9. [動画分析テスト](#test-09)
10. [コメント分析テスト](#test-10)
11. [包括分析テスト](#test-11)

### Phase 4: ダッシュボード・グラフテスト（新機能）
12. [自動グラフ生成テスト](#test-12)
13. [グラフ重複防止テスト](#test-13)

### Phase 5: AI機能テスト（新機能）
14. [AI質問機能テスト](#test-14)
15. [AI要約生成テスト](#test-15)

### Phase 6: UI・モード機能テスト（新機能）
16. [簡易モード切替テスト](#test-16)
17. [ヘルプ機能テスト](#test-17)

---

## 📝 詳細テスト手順

### <a id="test-01"></a>テスト01: 初期セットアップテスト

**目的**: 必要なシート・設定が正しく作成されることを確認

**前提条件**:
- 新しいGoogleスプレッドシートで実行
- コードが正しくインポート済み

**手順**:
1. メニュー「🛠 初期セットアップ」をクリック
2. 処理完了まで待機（30秒-1分）
3. 成功メッセージ「初期セットアップ完了」の表示を確認

**期待結果**:
- [ ] 以下7つのシートが作成される：
  - ✅ 検索語、チャンネル分析、動画分析、コメント分析、ダッシュボード、設定、ログ
- [ ] 「検索語」シートに15個の初期FXキーワードが設定される
- [ ] 「設定」シートに8個の初期設定項目が設定される
- [ ] 各シートにヘッダー行が正しく設定される
- [ ] エラーが発生せず完了する

**受け入れ基準**: 全シートが作成され、初期データが正しく設定されること

---

### <a id="test-02"></a>テスト02: メニュー表示テスト

**目的**: 全メニュー項目が正しく日本語で表示されることを確認

**手順**:
1. スプレッドシートをリロード（F5）
2. メニューバーの「🎯 YouTube分析 (日本FX特化)」をクリック
3. 表示されるメニュー項目を確認

**期待結果**:
- [ ] 以下11個のメニュー項目が正しい順序で表示される：
  1. 🛠 初期セットアップ
  2. 🔎 日本のFXチャンネル発見（1000人以上）
  3. ▶️ 全て実行
  4. 📺 チャンネル分析のみ
  5. 🎬 動画分析のみ
  6. 💬 コメント分析のみ
  7. 📊 ダッシュボード更新
  8. 🤖 ダッシュボード要約（AI）
  9. 🧭 簡易モード ON/OFF
  10. 🔧 設定
  11. 🗂 シート管理
  12. ❓ ヘルプ
- [ ] すべて日本語で表示される
- [ ] 適切なセパレーターが挿入される

**受け入れ基準**: 全メニューが日本語で期待通りに表示されること

---

### <a id="test-03"></a>テスト03: APIキー設定テスト

**目的**: YouTube Data API キーが正しく設定・保存されることを確認

**手順**:
1. メニュー「🔧 設定」をクリック
2. 「YouTube API キー設定」を選択
3. 取得済みのYouTube Data API v3 キーを入力
4. 「OK」をクリック

**期待結果**:
- [ ] 「設定完了」メッセージが表示される
- [ ] APIキーがScriptPropertiesに保存される（設定後の機能で確認）
- [ ] エラーが発生しない

**受け入れ基準**: APIキーが正しく保存され、後続のAPI呼び出しで使用できること

---

### <a id="test-04"></a>テスト04: シート構成テスト

**目的**: 各シートのカラムスキーマが仕様通りであることを確認

**手順**:
1. 各シートのヘッダー行を確認
2. カラム数と順序を検証

**期待結果**:

**チャンネル分析シート（13列）**:
- [ ] ['チャンネルID','チャンネル名','チャンネルURL','チャンネル説明','登録者数','総動画数','総再生回数','平均再生回数','チャンネル作成日','国','FX関連度','検証済み','分析日時']

**動画分析シート（14列）**:
- [ ] ['チャンネルID','チャンネル名','動画ID','動画タイトル','動画URL','公開日','再生回数','いいね数','コメント数','動画時間','FX関連度','感情スコア','キーワード','分析日時']

**コメント分析シート（10列）**:
- [ ] ['動画ID','動画タイトル','コメントID','投稿者','コメント内容','いいね数','投稿日時','FX関連度','感情スコア','キーワード']

**受け入れ基準**: 全シートのカラム構成が仕様書と完全に一致すること

---

### <a id="test-05"></a>テスト05: 日本FX特化チャンネル発見テスト

**目的**: 1000人以上のFX関連チャンネルが正しく発見されることを確認

**重要**: このテストは最もAPIクォータを消費します（200-500リクエスト）

**手順**:
1. 「検索語」シートの内容を確認（必要に応じて調整）
2. メニュー「🔎 日本のFXチャンネル発見（1000人以上）」をクリック
3. 処理完了まで待機（5-15分）
4. 「チャンネル分析」シートの結果を確認

**期待結果**:
- [ ] 10件以上のチャンネルが発見される（地域・時期により変動）
- [ ] 全チャンネルの登録者数が1000人以上
- [ ] 全チャンネルのFX関連度が設定しきい値（デフォルト2）以上
- [ ] チャンネルURL列が正しく設定される
- [ ] 明らかにFX無関係なチャンネル（ゲーム、料理等）が含まれない
- [ ] 「検証済み」列が「はい」になっている
- [ ] 重複チャンネルがない
- [ ] 処理完了メッセージが表示される

**確認ポイント**:
```
登録者数チェック: =MIN(チャンネル分析!E:E) >= 1000
FX関連度チェック: =MIN(チャンネル分析!K:K) >= 2
URL形式チェック: 
- @ハンドルがある場合: https://www.youtube.com/@ハンドル名
- ない場合: https://www.youtube.com/channel/チャンネルID
```

**受け入れ基準**: フィルター条件を満たすFX関連チャンネルのみが発見され、URL形式が正しいこと

---

### <a id="test-06"></a>テスト06: フィルタリング精度テスト

**目的**: FX関連性判定の精度を確認

**手順**:
1. テスト05の結果を使用
2. 発見されたチャンネル名・説明を手動確認
3. FX関連スコアの妥当性を検証

**期待結果**:
- [ ] チャンネル名にFXキーワードが含まれるチャンネルの割合 > 80%
- [ ] 明らかに無関係なチャンネル（料理、ゲーム、エンタメ等）が含まれない
- [ ] 日本語チャンネルが大部分を占める（英語のみは除外される）
- [ ] FX関連スコアが高いチャンネルほど関連性が高い

**手動確認項目**:
1. 上位10チャンネルの名前・説明を確認
2. 各チャンネルがFX・為替・投資に関連するかを判定
3. スコアと関連性の相関を確認

**受け入れ基準**: 発見チャンネルの90%以上がFX・投資関連であること

---

### <a id="test-07"></a>テスト07: チャンネルURL生成テスト

**目的**: @ハンドル優先のURL生成が正しく動作することを確認

**手順**:
1. テスト05の結果を使用
2. チャンネルURL列の値を確認
3. 実際にURLアクセスして検証

**期待結果**:
- [ ] 全行でチャンネルURL列に値が設定される
- [ ] @ハンドルを持つチャンネル: `https://www.youtube.com/@ハンドル名` 形式
- [ ] @ハンドルのないチャンネル: `https://www.youtube.com/channel/チャンネルID` 形式
- [ ] 生成されたURL3-5個が実際にアクセス可能（手動確認）
- [ ] URLクリックで該当チャンネルページが開く

**手動確認**:
1. 上位5チャンネルのURLをクリック
2. 正しいチャンネルページが開くことを確認
3. @ハンドルと通常URLの両パターンを確認

**受け入れ基準**: 全URLが有効で、正しいチャンネルページにリンクすること

---

### <a id="test-08"></a>テスト08: チャンネル分析テスト

**目的**: 個別チャンネル分析機能が正しく動作することを確認

**手順**:
1. テスト05でチャンネルが発見済みであることを確認
2. メニュー「📺 チャンネル分析のみ」をクリック
3. 処理完了まで待機（5-10分）
4. チャンネル分析シートの更新を確認

**期待結果**:
- [ ] 既存のチャンネル情報が更新される
- [ ] 新しい「分析日時」が設定される
- [ ] 登録者数、再生回数などの最新データが取得される
- [ ] 平均再生回数が正しく計算される（総再生回数/総動画数）
- [ ] エラーが発生せず完了する

**受け入れ基準**: 既存チャンネルのメトリクスが最新データで更新されること

---

### <a id="test-09"></a>テスト09: 動画分析テスト

**目的**: チャンネルの動画詳細分析が正しく動作することを確認

**手順**:
1. テスト08が完了していることを確認
2. メニュー「🎬 動画分析のみ」をクリック
3. 処理完了まで待機（10-20分）
4. 動画分析シートの結果を確認

**期待結果**:
- [ ] 各チャンネルから最大50本の動画データが取得される
- [ ] 動画ID、タイトル、URL、再生回数等が正しく設定される
- [ ] 動画時間が適切なフォーマット（mm:ss または h:mm:ss）で表示される
- [ ] FX関連度が0-10の範囲で計算される
- [ ] 感情スコアが-5から+5の範囲で設定される
- [ ] キーワードが抽出される
- [ ] 総動画数が100本以上取得される（複数チャンネル合計）

**データ品質確認**:
- [ ] 動画URLクリックで正しい動画ページが開く
- [ ] 再生回数が0以上の数値
- [ ] 公開日が適切な日付形式

**受け入れ基準**: 複数チャンネルから動画データが取得され、各項目が適切に計算されること

---

### <a id="test-10"></a>テスト10: コメント分析テスト

**目的**: 動画コメントの分析機能が正しく動作することを確認

**手順**:
1. テスト09が完了していることを確認
2. メニュー「💬 コメント分析のみ」をクリック
3. 処理完了まで待機（15-30分）
4. コメント分析シートの結果を確認

**期待結果**:
- [ ] 動画からコメントデータが取得される（コメント無効な動画は除く）
- [ ] コメント内容、投稿者、いいね数等が設定される
- [ ] FX関連度と感情スコアが計算される
- [ ] キーワードが抽出される
- [ ] 総コメント数が200件以上取得される（エラー動画除く）

**注意事項**:
- コメント取得不可能な動画はスキップされる（正常動作）
- プライベート・削除動画でエラーが発生する場合は正常

**受け入れ基準**: 利用可能な動画からコメントが取得され、適切に分析されること

---

### <a id="test-11"></a>テスト11: 包括分析テスト

**目的**: 全分析機能の一括実行が正しく動作することを確認

**手順**:
1. 新しいスプレッドシートで初期セットアップから開始
2. チャンネル発見を実行
3. メニュー「▶️ 全て実行」をクリック
4. 処理完了まで待機（20-40分）
5. 全シートの結果を確認

**期待結果**:
- [ ] チャンネル分析が実行される
- [ ] 動画分析が実行される  
- [ ] コメント分析が実行される
- [ ] ダッシュボードが更新される
- [ ] 全工程でエラーが発生せず完了する
- [ ] 成功メッセージが表示される

**受け入れ基準**: 全分析工程が順次実行され、エラーなしに完了すること

---

### <a id="test-12"></a>テスト12: 自動グラフ生成テスト

**目的**: ダッシュボードのグラフが自動生成されることを確認

**手順**:
1. テスト11が完了していることを確認
2. メニュー「📊 ダッシュボード更新」をクリック
3. ダッシュボードシートを確認

**期待結果**:
- [ ] 以下の3つのグラフが生成される：
  1. ✅ 上位20チャンネル - 登録者数（棒グラフ）
  2. ✅ 上位20チャンネル - 平均再生回数（棒グラフ）  
  3. ✅ 上位20動画 - 再生回数（棒グラフ）
- [ ] 各グラフが適切な位置に配置される
- [ ] グラフタイトル・軸ラベルが日本語で表示される
- [ ] グラフサイズが600x400pxで見やすい
- [ ] データが正しくソートされている（降順）

**視覚的確認**:
- [ ] グラフが重なっていない
- [ ] データラベルが読みやすい
- [ ] 統計情報（最終更新、チャンネル数等）が表示される

**受け入れ基準**: 3種類のグラフが自動生成され、適切にレイアウトされること

---

### <a id="test-13"></a>テスト13: グラフ重複防止テスト

**目的**: ダッシュボード再実行時にグラフが重複作成されないことを確認

**手順**:
1. テスト12が完了していることを確認
2. 現在のグラフ数を確認（3個のはず）
3. メニュー「📊 ダッシュボード更新」を再度実行
4. グラフ数を再確認

**期待結果**:
- [ ] グラフ数が3個のまま維持される
- [ ] 既存のグラフが削除され、新しいグラフが作成される
- [ ] グラフが重複して6個や9個にならない
- [ ] データが最新に更新される

**受け入れ基準**: 再実行してもグラフが重複作成されず、データのみ更新されること

---

### <a id="test-14"></a>テスト14: AI質問機能テスト

**目的**: ASK_AI カスタム関数が正しく動作することを確認

**前提条件**: AI APIキー（AnthropicまたはOpenAI）が設定済み

**手順**:
1. 設定シートでAPIキーが設定されていることを確認
2. ダッシュボードシートの空いているセルに以下を入力：
   ```
   =ASK_AI("上位チャンネルの特徴を教えてください")
   ```
3. Enterキーを押して実行
4. 結果を確認

**期待結果**:
- [ ] 5秒-30秒でAIの回答が返される
- [ ] 日本語で回答される
- [ ] チャンネル分析データに基づいた内容が含まれる
- [ ] エラーメッセージではない

**追加テスト**:
```
=ASK_AI("最も注目すべきチャンネルは？", チャンネル分析!A1:M20)
=ASK_AI("動画の再生回数の傾向は？", 動画分析!A1:N100)
```

**受け入れ基準**: APIキー設定時に日本語で有用な分析結果が返されること

---

### <a id="test-15"></a>テスト15: AI要約生成テスト

**目的**: ダッシュボードAI要約機能が正しく動作することを確認

**前提条件**: テスト14が成功していること

**手順**:
1. メニュー「🤖 ダッシュボード要約（AI）」をクリック
2. 処理完了まで待機（10-30秒）
3. ダッシュボードシートの「AI要約」セクションを確認

**期待結果**:
- [ ] ダッシュボード下部に「AI要約」行が追加される
- [ ] 3-5行程度の要約文が日本語で生成される
- [ ] 登録者数、再生数、FX関連度等の観点が含まれる
- [ ] 背景色が設定される（緑系）
- [ ] 成功メッセージが表示される

**内容品質確認**:
- [ ] 分析データに基づいた内容
- [ ] 具体的な数値や傾向が含まれる
- [ ] FX市場の観点からの洞察

**受け入れ基準**: データに基づいた有用なAI要約がダッシュボードに生成されること

---

### <a id="test-16"></a>テスト16: 簡易モード切替テスト

**目的**: 簡易モードの切り替えが正しく動作することを確認

**手順**:
1. 現在表示されているシートタブ数を確認（通常7個以上）
2. メニュー「🧭 簡易モード ON/OFF」をクリック
3. シートタブの変化を確認
4. 再度同メニューをクリック
5. 元の状態に戻ることを確認

**期待結果**:

**簡易モードON時**:
- [ ] 以下の6シートのみ表示される：
  - 検索語、チャンネル分析、動画分析、ダッシュボード、設定、ログ
- [ ] 他のシート（コメント分析等）が非表示になる
- [ ] 「簡易モードをONにしました」メッセージが表示される

**簡易モードOFF時**:
- [ ] 全シートが表示状態に戻る
- [ ] 非表示になっていたシートが再表示される
- [ ] 「簡易モードをOFFにしました」メッセージが表示される

**設定確認**:
- [ ] 設定シートの「SIMPLE_MODE」値がON/OFFで変化する

**受け入れ基準**: ワンクリックでシート表示が切り替わり、設定が保存されること

---

### <a id="test-17"></a>テスト17: ヘルプ機能テスト

**目的**: ヘルプ機能が適切な情報を提供することを確認

**手順**:
1. メニュー「❓ ヘルプ」をクリック
2. 表示されるヘルプ内容を確認

**期待結果**:
- [ ] ヘルプダイアログが日本語で表示される
- [ ] 以下の情報が含まれる：
  - 基本的な使い方（5ステップ程度）
  - 個別機能の説明
  - AI機能の使用方法
  - 注意事項
  - トラブルシューティング
- [ ] 実用的で理解しやすい内容
- [ ] 改行・セクション分けが適切

**内容品質確認**:
- [ ] 初心者でも理解できる説明
- [ ] 具体的な例が含まれる
- [ ] エラー対処方法が含まれる

**受け入れ基準**: 利用者が困った時に参照できる有用なヘルプ情報が提供されること

---

## ✅ 総合受け入れ基準

### 必須達成項目（Doneの定義）

#### 🎯 コア機能
1. **チャンネル発見**: 「🔎 日本のFXチャンネル発見（1000人以上）」実行で、チャンネル分析にURL列を含む一覧が生成され、登録者1000未満は含まれない
2. **フィルタリング精度**: 明らかにFX無関係なチャンネルは「FX関連度」しきい値で除外される
3. **ダッシュボード**: 上位20の棒グラフ（登録者数・平均再生・動画再生）が自動生成され、再実行しても重複しない
4. **簡易モード**: 「🧭 簡易モード ON」で指定タブのみ表示、OFFで復帰する

#### 🤖 AI機能
5. **AI質問**: `=ASK_AI("上位の傾向を要約して")` がキー設定時に日本語で要約を返す
6. **AI要約**: ダッシュボード要約（AI）でデータ分析結果が生成される

#### 🌐 UI・UX
7. **日本語対応**: すべてのメニュー/メッセージ/コメントは日本語
8. **ヘルプ**: ヘルプから使い方が分かる

#### 🔄 統合版継承
9. **既存機能**: 「全て実行/個別実行」も動作する（発見済みor設定済みチャンネルを対象）

### パフォーマンス基準

#### ⏱️ 処理時間
- チャンネル発見: 15分以内
- 全分析実行: 40分以内  
- ダッシュボード更新: 2分以内
- AI要約生成: 30秒以内

#### 📊 データ品質
- 発見チャンネル: 10件以上
- FX関連精度: 90%以上
- URL有効性: 100%
- グラフ表示: 3種類すべて

#### 🛡️ 安定性
- エラー率: 5%以下（API制限除く）
- 再実行成功率: 95%以上
- UI応答性: 良好

### API使用量基準

#### 📈 クォータ管理
- 日次制限: 10,000リクエスト以内
- チャンネル発見: 500リクエスト程度
- 全分析実行: 1000リクエスト程度

## 🚨 テスト失敗時の対応

### 段階的対処法

#### Level 1: 設定確認
1. APIキーの再設定
2. Advanced Servicesの確認
3. 権限の再付与

#### Level 2: パラメータ調整
1. MAX_SEARCH を100に減らす
2. FX_THRESHOLD を1に下げる
3. MIN_SUBSCRIBERS を500に下げる

#### Level 3: 段階実行
1. 初期セットアップのみ実行
2. チャンネル発見のみ実行
3. 個別分析を順次実行

#### Level 4: ログ分析
1. ログシートでエラー詳細確認
2. GAS実行履歴の確認
3. API使用量の確認

### 既知の制約・制限事項

#### YouTube API制限
- 1日10,000リクエスト制限
- 地域判定の精度限界
- コメント取得不可動画の存在

#### FX関連判定精度
- キーワードベースのため誤検出可能性あり
- 英語チャンネル判定の限界

#### AI機能制限
- 外部API依存（可用性・レスポンス時間）
- APIクォータ制限
- 回答品質のばらつき

---

## 📋 テスト完了チェックリスト

### Phase 1: 基本セットアップ（必須）
- [ ] テスト01: 初期セットアップ ✅
- [ ] テスト02: メニュー表示 ✅
- [ ] テスト03: APIキー設定 ✅
- [ ] テスト04: シート構成 ✅

### Phase 2: チャンネル発見（コア）
- [ ] テスト05: FXチャンネル発見 ✅
- [ ] テスト06: フィルタリング精度 ✅
- [ ] テスト07: チャンネルURL生成 ✅

### Phase 3: 分析機能（統合版）
- [ ] テスト08: チャンネル分析 ✅
- [ ] テスト09: 動画分析 ✅
- [ ] テスト10: コメント分析 ✅
- [ ] テスト11: 包括分析 ✅

### Phase 4: ダッシュボード（新機能）
- [ ] テスト12: 自動グラフ生成 ✅
- [ ] テスト13: グラフ重複防止 ✅

### Phase 5: AI機能（新機能）
- [ ] テスト14: AI質問機能 ✅
- [ ] テスト15: AI要約生成 ✅

### Phase 6: UI・モード（新機能）
- [ ] テスト16: 簡易モード切替 ✅
- [ ] テスト17: ヘルプ機能 ✅

### 🎉 最終承認
- [ ] **全17テストケース PASS**
- [ ] **受け入れ基準9項目 達成**
- [ ] **パフォーマンス基準 クリア**
- [ ] **ドキュメント完成**

**テスト完了日**: _______________
**承認者**: _______________
**備考**: _______________